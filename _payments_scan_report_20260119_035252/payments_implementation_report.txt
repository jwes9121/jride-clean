JRIDE PAYMENTS IMPLEMENTATION SCAN REPORT
Generated: 2026-01-19 03:52:59
Repo root:  C:\Users\jwes9\Desktop\jride-clean-fresh

=== 1) Provider / Payment Keywords Found ===

- powershell.txt  (hits=866)
  terms: payout, wallet, driver_wallet, wallet_transactions, vendor_wallet, top-up
  L112: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                     76             title: "Driver Payouts",
  L113: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                     77             desc: "Driver payout records and status overview.",
  L114: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                     78             href: "/admin/driver-payouts",
  L115: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                    112             title: "Driver Payout Requests (LGU View)",
  L116: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                    113             desc: "LGU-safe view of driver payout requests.",

- app\takeout\vendor\payout\page.tsx  (hits=85)
  terms: billing, wallet, payout
  L7: total_billings: number;
  L10: wallet_balance: number;
  L11: last_payout_at: string | null;
  L12: last_payout_amount: number | null;
  L18: total_billings: number;

- components\PaymentMethodModal.tsx  (hits=55)
  terms: gcash, xendit, wallet
  L9: onConfirm: (paymentMethod: 'wallet' | 'cash' | 'points' | 'gcash_xendit') => void;
  L14: const [selectedMethod, setSelectedMethod] = useState<'wallet' | 'cash' | 'points' | 'gcash_xendit'>('cash');
  L15: const [walletBalance, setWalletBalance] = useState(0);
  L17: const [showGCashConfirmation, setShowGCashConfirmation] = useState(false);
  L18: const [gCashFees, setGCashFees] = useState({ percentage: 0, fixed: 0, total: 0 });

- components\components\PaymentMethodModal.tsx  (hits=55)
  terms: gcash, xendit, wallet
  L9: onConfirm: (paymentMethod: 'wallet' | 'cash' | 'points' | 'gcash_xendit') => void;
  L14: const [selectedMethod, setSelectedMethod] = useState<'wallet' | 'cash' | 'points' | 'gcash_xendit'>('cash');
  L15: const [walletBalance, setWalletBalance] = useState(0);
  L17: const [showGCashConfirmation, setShowGCashConfirmation] = useState(false);
  L18: const [gCashFees, setGCashFees] = useState({ percentage: 0, fixed: 0, total: 0 });

- app\takeout\admin\payouts\page.tsx  (hits=49)
  terms: billing, wallet, payout
  L10: total_billings: number;
  L13: wallet_balance: number;
  L14: last_payout_at: string | null;
  L15: last_payout_amount: number | null;
  L18: export default function AdminVendorPayoutsPage() {

- app\admin\payouts\drivers\page.tsx  (hits=41)
  terms: payout, wallet, topup, gcash
  L8: type PayoutRow = {
  L16: payout_method: string | null;
  L17: payout_ref: string | null;
  L20: wallet_balance?: number | null;
  L21: min_wallet_required?: number | null;

- app\driver\page.tsx  (hits=40)
  terms: wallet, payout, driver_wallet, gcash
  L18: type WalletStatus = {
  L20: wallet_balance: number;
  L21: min_wallet_required: number;
  L22: wallet_status: string | null;
  L26: type Payout = {

- app\dispatch\page.tsx  (hits=37)
  terms: wallet
  L289: const [lowWalletOnly, setLowWalletOnly] = useState<boolean>(false);
  L295: /* JRIDE_UI_MONEY_PHASE2_LOWWALLET_PANEL_START */
  L296: const lowWalletDrivers = useMemo(() => {
  L308: const bal = toNum((d as any).wallet_balance);
  L309: const min = toNum((d as any).min_wallet_required);

- app\api\public\passenger\can-book\route.ts  (hits=37)
  terms: wallet
  L166: async function resolvePassengerWallet(supabase: ReturnType<typeof createClient>) {
  L170: wallet_locked: false,
  L171: wallet_balance: null as number | null,
  L172: min_wallet_required: null as number | null,
  L182: out.note = "No auth user (not signed in). Wallet precheck not enforced.";

- app\wallet\page.tsx  (hits=28)
  terms: wallet, payout, topup, top-up, cashout
  L11: wallet_balance: number;
  L16: type: 'credit' | 'debit' | 'topup' | 'payout' | 'ride' | 'errand' | 'vendor_order';
  L24: export default function WalletPage() {
  L32: loadWalletData();
  L63: loadWalletData();

- components\DriverWalletLedger.tsx  (hits=26)
  terms: cashout, wallet, payout, transfer
  L38: cashouts: {
  L46: interface DriverWalletLedgerProps {
  L51: export default function DriverWalletLedger({ isOpen, onClose }: DriverWalletLedgerProps) {
  L71: const response = await fetch(`${process.env.NEXT_PUBLIC_SUPABASE_URL}/functions/v1/wallet-service`, {
  L102: case 'driver_cashout': return 'ri-bank-line text-blue-500';

- components\components\DriverWalletLedger.tsx  (hits=26)
  terms: cashout, wallet, payout, transfer
  L38: cashouts: {
  L46: interface DriverWalletLedgerProps {
  L51: export default function DriverWalletLedger({ isOpen, onClose }: DriverWalletLedgerProps) {
  L71: const response = await fetch(`${process.env.NEXT_PUBLIC_SUPABASE_URL}/functions/v1/wallet-service`, {
  L102: case 'driver_cashout': return 'ri-bank-line text-blue-500';

- app\api\takeout\vendor-wallet\route.ts  (hits=25)
  terms: wallet, vendor_wallet, wallet_transactions, payout
  L51: console.error("❌ Supabase env vars missing for vendor-wallet API");
  L60: // 0) Auto-sync this vendor's completed TAKEOUT orders into the wallet
  L62: "sync_vendor_takeout_wallet",
  L67: console.error("❌ Error running sync_vendor_takeout_wallet:", syncError);
  L68: // Continue; wallet may still contain previous data.

- app\api\dispatch\status\route.ts  (hits=24)
  terms: wallet, signature
  L185: * PHASE 3L - wallet sync (completion only)
  L186: * IMPORTANT: Do NOT call admin_finalize_trip_and_credit_wallets(text)
  L187: * because you have a DB trigger that credits driver wallet on status -> completed.
  L191: * - apply platform cut via process_booking_wallet_cut(p_booking_id uuid)
  L192: * - for takeout: sync vendor wallet via sync_vendor_takeout_wallet(v_vendor_id uuid)

- app\api\takeout\vendor\payout\details\route.ts  (hits=23)
  terms: payout, wallet, billing, wallet_transactions, vendor_wallet
  L19: console.error("❌ Supabase env vars missing in vendor payout details API");
  L59: .from("admin_vendor_payout_summary")
  L61: "vendor_id,total_billings,total_platform_fees,total_vendor_earnings,wallet_balance,last_payout_at,last_payout_amount"
  L67: console.error("❌ admin_vendor_payout_summary error:", summaryError);
  L78: .from("admin_vendor_payout_monthly")

- _patch_backups\20251222-182002\app\api\admin\livetrips\page-data\route.ts  (hits=22)
  terms: wallet, driver_wallet, wallet_transactions, vendor_wallet
  L75: // 3) Wallet enrichment (best-effort, never blocks response)
  L76: const driverWalletBalances: Record<string, number> = {};
  L77: const vendorWalletBalances: Record<string, number> = {};
  L100: .from("driver_wallet_balances_v1")
  L105: console.error("[wallet] driver_wallet_balances_v1 error", derr);

- app\ride\page.tsx  (hits=22)
  terms: wallet
  L264: wallet_ok?: boolean;
  L265: wallet_locked?: boolean;
  L266: wallet_balance?: number | null;
  L267: min_wallet_required?: number | null;
  L268: wallet_source?: string;

- app\takeout\admin\payout-requests\page.tsx  (hits=21)
  terms: payout, wallet
  L6: type PayoutRequestRow = {
  L19: export default function AdminPayoutRequestsPage() {
  L24: const [rows, setRows] = useState<PayoutRequestRow[]>([]);
  L32: "/api/takeout/admin/vendor-payout/list-requests"
  L37: throw new Error(json.error || "Failed to load payout requests.");

- app\admin\livetrips\components\TripWalletPanel.tsx  (hits=21)
  terms: wallet, vendor_wallet, payout, driver_wallet
  L120: export default function TripWalletPanel(props: Props) {
  L128: const vb = asNum(trip?.vendor_wallet_balance);
  L138: const vb = asNum(trip?.vendor_wallet_balance);
  L166: // If no explicit field, for TAKEOUT show derived cut from vendor_wallet_balance (10% rule)
  L170: const driverPayout = useMemo(() => {

- app\driver\wallet\page.tsx  (hits=21)
  terms: wallet, payout, load wallet
  L5: type WalletTx = {
  L15: type PayoutReq = {
  L22: payout_method: string | null;
  L23: payout_ref: string | null;
  L36: export default function DriverWalletPage() {

- app\api\dispatch\drivers-live\route.ts  (hits=20)
  terms: wallet
  L172: const walletSources = [
  L181: const walletRes = await trySources(supabase, walletSources, "*");
  L206: const walletById: Record<string, any> = {};
  L207: const walletSrcById: Record<string, string> = {};
  L208: if (walletRes) {

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013808\livetrips_current\components\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- backups\KEEP_AdminPayoutPanel_20251215_024101\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- backups\PAYOUT_PANEL_SCROLL_FIX_20251214_092634\app\admin\livetrips\components\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- backups\RESTORE_LIVETRIPS_20251215_023821\livetrips_current\components\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013551\livetrips_current\components\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- app\api\takeout\admin\vendor-payout\settle-request\route.ts  (hits=18)
  terms: payout, wallet, wallet_transactions, vendor_wallet
  L39: // 1) Load payout request
  L41: .from("vendor_payout_requests")
  L49: console.error("❌ vendor_payout_requests load error:", requestError);
  L59: { error: "Payout request not found" },
  L66: { error: "Payout request is not pending" },

- app\takeout\vendor\payouts\page.tsx  (hits=18)
  terms: payout, billing
  L16: driver_payout: number;
  L31: grossBillings: number;
  L119: grossBillings: 0,
  L150: bucket.grossBillings = gross;
  L166: export default function VendorPayoutsPage() {

- app\api\takeout\vendor\payout\route.ts  (hits=18)
  terms: payout, wallet, wallet_transactions, vendor_wallet
  L19: console.error("❌ Supabase env vars missing for vendor payout API");
  L63: .from("admin_vendor_payout_summary")
  L69: console.error("❌ Error loading admin_vendor_payout_summary:", summaryError);
  L78: // 3) Monthly earnings/payouts
  L80: .from("admin_vendor_payout_monthly")

- app\api\takeout\vendor\payout\request\route.ts  (hits=18)
  terms: payout, wallet
  L16: console.error("❌ Supabase env vars missing in vendor payout request API");
  L54: // 2) Get wallet balance for this vendor
  L56: .from("admin_vendor_payout_summary")
  L57: .select("wallet_balance")
  L62: console.error("❌ admin_vendor_payout_summary error:", summaryError);

- tmp_page_data_debug.json  (hits=17)
  terms: payout
  L22: "driver_payout":  70,
  L47: "driver_payout":  70,
  L72: "driver_payout":  70,
  L97: "driver_payout":  70,
  L122: "driver_payout":  70,

- app\api\admin\reconcile-wallets\route.ts  (hits=17)
  terms: payout, wallet, wallet_transactions, driver_wallet, vendor_wallet
  L51: // Pull fields needed to compute expected payout
  L54: .select("id,booking_code,status,service_type,vendor_status,driver_id,vendor_id,updated_at,driver_payout,verified_fare,company_cut")
  L66: .from("driver_wallet_transactions")
  L72: if (dErr) return json(500, { ok: false, code: "DB_ERROR", stage: "driver_wallet_transactions", message: dErr.message });
  L75: .from("vendor_wallet_transactions")

- app\admin\control-center\page.tsx  (hits=16)
  terms: payout, wallet
  L87: title: "Driver Payouts",
  L88: desc: "Driver payout records and status overview.",
  L89: href: "/admin/driver-payouts",
  L92: title: "Vendor Payouts",
  L93: desc: "Vendor payout records and request list.",

- app\admin\driver-payouts\page.tsx  (hits=16)
  terms: payout, gcash, wallet
  L5: type PayoutRow = {
  L12: payout_method?: string | null;
  L13: payout_ref?: string | null;
  L39: export default function AdminDriverPayoutsPage() {
  L41: const [rows, setRows] = useState<PayoutRow[]>([]);

- app\api\takeout\vendor\request-payout\route.ts  (hits=16)
  terms: payout, wallet
  L16: console.error("❌ Supabase env vars missing for vendor request-payout API");
  L58: // 2) Current wallet balance from summary view
  L60: .from("admin_vendor_payout_summary")
  L61: .select("wallet_balance")
  L66: console.error("❌ Error loading admin_vendor_payout_summary:", summaryError);

- backups\DISPATCH_HARDENING_PREPATCH_20251220_174751\_git_status_porcelain.txt  (hits=14)
  terms: callback, wallet, topup
  L11: M app/callback-info/page.tsx
  L26: M app/wallet/page.tsx
  L27: M app/wallet/topup/page.tsx
  L50: M components/DriverWalletLedger.tsx
  L71: M components/WalletSection.tsx

- app\api\vendor\payout-request\route.ts  (hits=13)
  terms: payout, wallet, wallet_transactions, vendor_wallet
  L19: function minPayout() {
  L20: const v = n(process.env.VENDOR_PAYOUT_MIN);
  L29: route: "/api/vendor/payout-request",
  L37: min_payout_default: 250,
  L38: min_payout_env: process.env.VENDOR_PAYOUT_MIN ?? null,

- app\api\admin\driver-payouts\route.ts  (hits=13)
  terms: payout
  L21: qs.set("select", "id,driver_id,amount,status,requested_at,processed_at,payout_method,payout_ref,receipt_url,admin_note");
  L25: const url = SUPABASE_URL + "/rest/v1/driver_payout_requests?" + qs.toString();
  L48: qs.set("select", "id,driver_id,amount,status,requested_at,processed_at,payout_method,payout_ref,receipt_url,admin_note");
  L50: const url = SUPABASE_URL + "/rest/v1/driver_payout_requests?" + qs.toString();
  L81: qs.set("select", "id,driver_id,amount,status,requested_at,processed_at,payout_method,payout_ref,receipt_url,admin_note");

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\components\TripWalletPanel.tsx  (hits=13)
  terms: wallet, payout, driver_wallet, vendor_wallet
  L45: export default function TripWalletPanel({ trip }: Props) {
  L48: const driverPayout = useMemo(() => trip?.driver_payout ?? null, [trip]);
  L50: // Wallet balances aren't on bookings in your schema; show if API provides computed fields.
  L51: const driverWallet = useMemo(
  L52: () => trip?.driver_wallet_balance ?? trip?.driver_wallet ?? trip?.driverWallet ?? null,

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\components\TripWalletPanel.tsx  (hits=13)
  terms: wallet, payout, driver_wallet, vendor_wallet
  L45: export default function TripWalletPanel({ trip }: Props) {
  L48: const driverPayout = useMemo(() => trip?.driver_payout ?? null, [trip]);
  L50: // Wallet balances aren't on bookings in your schema; show if API provides computed fields.
  L51: const driverWallet = useMemo(
  L52: () => trip?.driver_wallet_balance ?? trip?.driver_wallet ?? trip?.driverWallet ?? null,

- app\admin\vendor-payouts-summary\page.tsx  (hits=12)
  terms: payout, billing, wallet
  L43: export default function AdminVendorPayoutsSummaryPage() {
  L55: const v = localStorage.getItem("vendor_payouts_summary_view");
  L56: const m = localStorage.getItem("vendor_payouts_summary_month");
  L57: const vid = localStorage.getItem("vendor_payouts_summary_vendor");
  L66: localStorage.setItem("vendor_payouts_summary_view", view);

- components\WalletSection.tsx  (hits=10)
  terms: wallet, topup, cashout
  L7: interface WalletSectionProps {
  L8: walletBalance?: number;
  L12: export default function WalletSection({ walletBalance = 0, rewardPoints = 0 }: WalletSectionProps) {
  L16: const safeWalletBalance = typeof walletBalance === 'number' ? walletBalance : 0;
  L32: <h3 className="text-lg font-semibold opacity-90">J-Ride Wallet</h3>

- backups\FIX_CLIENT_LOOP_20251214_230152\LiveTripsClient.tsx  (hits=10)
  terms: callback, payout
  L3: import React, { useCallback, useEffect, useMemo, useState } from "react";
  L11: import AdminPayoutPanel, { AdminPayoutRow } from "./components/AdminPayoutPanel";
  L68: const [payoutRows, setPayoutRows] = useState<AdminPayoutRow[]>([]);
  L112: // Admin payout requests view
  L113: const pRes = await supabase.from("admin_driver_payout_requests_v1").select("*").limit(500);

- app\api\driver\payout-request\route.ts  (hits=10)
  terms: payout, wallet, driver_wallet
  L19: function minPayout() {
  L20: const v = n(process.env.DRIVER_PAYOUT_MIN);
  L29: route: "/api/driver/payout-request",
  L37: min_payout_default: 250,
  L38: min_payout_env: process.env.DRIVER_PAYOUT_MIN ?? null,

- backups\FIX_CLIENT_LOOP_20251214_230543\LiveTripsClient.tsx  (hits=10)
  terms: callback, payout
  L3: import React, { useCallback, useEffect, useMemo, useState } from "react";
  L11: import AdminPayoutPanel, { AdminPayoutRow } from "./components/AdminPayoutPanel";
  L68: const [payoutRows, setPayoutRows] = useState<AdminPayoutRow[]>([]);
  L112: // Admin payout requests view
  L113: const pRes = await supabase.from("admin_driver_payout_requests_v1").select("*").limit(500);

- backups\FIX_CLIENT_LOOP_20251214_231214\LiveTripsClient.tsx  (hits=10)
  terms: callback, payout
  L3: import React, { useCallback, useEffect, useMemo, useState } from "react";
  L11: import AdminPayoutPanel, { AdminPayoutRow } from "./components/AdminPayoutPanel";
  L68: const [payoutRows, setPayoutRows] = useState<AdminPayoutRow[]>([]);
  L112: // Admin payout requests view
  L113: const pRes = await supabase.from("admin_driver_payout_requests_v1").select("*").limit(500);

- app\admin\payouts\drivers\reports\page.tsx  (hits=10)
  terms: payout, wallet
  L34: return { kind: "ok", text: "Nothing to auto-approve (no pending payouts).", raw };
  L42: return { kind: "warn", text: `No payouts approved. Skipped ${insuff} due to insufficient wallet after payout.`, raw };
  L45: return { kind: "warn", text: "Auto-approve finished. No payouts approved.", raw };
  L68: export default function DriverPayoutReportsPage() {
  L86: return `/api/admin/driver-payouts/export?${qs.toString()}`;

- components\components\WalletSection.tsx  (hits=10)
  terms: wallet, topup, cashout
  L7: interface WalletSectionProps {
  L8: walletBalance?: number;
  L12: export default function WalletSection({ walletBalance = 0, rewardPoints = 0 }: WalletSectionProps) {
  L16: const safeWalletBalance = typeof walletBalance === 'number' ? walletBalance : 0;
  L32: <h3 className="text-lg font-semibold opacity-90">J-Ride Wallet</h3>

- backups\RESTORE_LIVETRIPS_20251214_231937\LiveTripsClient.tsx  (hits=10)
  terms: callback, payout
  L3: import React, { useCallback, useEffect, useMemo, useState } from "react";
  L11: import AdminPayoutPanel, { AdminPayoutRow } from "./components/AdminPayoutPanel";
  L68: const [payoutRows, setPayoutRows] = useState<AdminPayoutRow[]>([]);
  L112: // Admin payout requests view
  L113: const pRes = await supabase.from("admin_driver_payout_requests_v1").select("*").limit(500);

- app\api\admin\reconcile-wallets\fix\route.ts  (hits=10)
  terms: payout, wallet, wallet_transactions, driver_wallet
  L37: // expected payout logic (matches reconcile-wallets route)
  L38: function expectedDriverPayout(b: any) {
  L39: const dp = n(b?.driver_payout);
  L51: message: "POST { mode: 'dry_run'|'apply' } to backfill missing driver credits (expected payout > 0).",
  L76: // Pull completed bookings with fields needed to compute expected payout

- app\admin\vendor-payouts\page.tsx  (hits=9)
  terms: payout, wallet
  L30: export default function AdminVendorPayoutsPage() {
  L44: const v = localStorage.getItem("vendor_payouts_reviewed_by");
  L53: const res = await fetch(`/api/admin/vendor-payouts?status=${status}&limit=200`, { cache: "no-store" });
  L55: if (!res.ok) throw new Error(data?.message || data?.error || "Failed to load vendor payouts");
  L70: localStorage.setItem("vendor_payouts_reviewed_by", reviewedBy || "admin");

- app\auth\signin\page.tsx  (hits=8)
  terms: callback
  L6: callbackUrl?: string;
  L12: const rawCallback = searchParams?.callbackUrl;
  L15: let callbackUrl = "/admin/livetrips";
  L17: if (typeof rawCallback === "string" && rawCallback.length > 0) {
  L18: if (rawCallback.startsWith("/admin/livetrip")) {

- backups\FIX_STUCKWATCHER_LOOP_20251214_203050\LiveTripsClient.tsx  (hits=8)
  terms: payout
  L11: import AdminPayoutPanel, { AdminPayoutRow } from "./components/AdminPayoutPanel";
  L68: const [payoutRows, setPayoutRows] = useState<AdminPayoutRow[]>([]);
  L112: // Admin payout requests view
  L113: const pRes = await supabase.from("admin_driver_payout_requests_v1").select("*").limit(500);
  L114: if (pRes.error) console.error("[admin_driver_payout_requests_v1] error:", pRes.error);

- backups\PAYOUT_PANEL_SCROLL_FIX_20251214_092634\app\admin\livetrips\LiveTripsClient.tsx  (hits=8)
  terms: payout
  L11: import AdminPayoutPanel, { AdminPayoutRow } from "./components/AdminPayoutPanel";
  L68: const [payoutRows, setPayoutRows] = useState<AdminPayoutRow[]>([]);
  L112: // Admin payout requests view
  L113: const pRes = await supabase.from("admin_driver_payout_requests_v1").select("*").limit(500);
  L114: if (pRes.error) console.error("[admin_driver_payout_requests_v1] error:", pRes.error);

- _scan_fare_hits.txt  (hits=8)
  terms: wallet, payout
  L1: @{Path=C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\livetrips\components\TripWalletPanel.tsx; LineNumber=34; Line= * bookings has verified_fare, proposed_fare, total_errand_fare, and components:}
  L2: @{Path=C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\livetrips\components\TripWalletPanel.tsx; LineNumber=62; Line=  const verified = asNum(trip?.verified_fare);}
  L3: @{Path=C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\livetrips\components\TripWalletPanel.tsx; LineNumber=65; Line=  const proposed = asNum(trip?.proposed_fare);}
  L5: @{Path=C:\Users\jwes9\Desktop\jride-clean-fresh\app\api\admin\reconcile-wallets\fix\route.ts; LineNumber=41; Line=  const vf = n(b?.verified_fare);}
  L6: @{Path=C:\Users\jwes9\Desktop\jride-clean-fresh\app\api\admin\reconcile-wallets\fix\route.ts; LineNumber=79; Line=      .select("id,booking_code,status,driver_id,driver_payout,verified_fare,company_cut")}

- app\api\public\passenger\book\route.ts  (hits=8)
  terms: wallet
  L290: const selW = "wallet_balance,min_wallet_required,wallet_locked";
  L303: const locked = row.wallet_locked === true;
  L304: const bal = typeof row.wallet_balance === "number" ? row.wallet_balance : null;
  L305: const min = typeof row.min_wallet_required === "number" ? row.min_wallet_required : null;
  L310: out.code = "WALLET_LOCKED";

- app\api\admin\livetrips\apply-fare\route.ts  (hits=7)
  terms: payout
  L47: // Fetch bits used to compute passenger totals/cut/payout (best-effort)
  L68: // driver_payout = base_fare + pickup_distance_fee
  L72: driver_payout: Math.round((fare + pickupFee) * 100) / 100,
  L76: // Do not write payout/cut/total for takeout yet; informational only
  L77: return ok({ ok: true, applied_field, computed, note: "TAKEOUT_SKIPPED_PAYOUT_RECOMPUTE" });

- app\api\admin\vendor-payouts\route.ts  (hits=7)
  terms: payout, wallet
  L25: const url = SUPABASE_URL + "/rest/v1/vendor_payout_requests?" + qs.toString();
  L45: const url = SUPABASE_URL + "/rest/v1/vendor_payout_requests?" + qs.toString();
  L81: const restUrl = SUPABASE_URL + "/rest/v1/vendor_payout_requests?" + qs.toString();
  L122: if (!cur.ok) return jsonErr("DB_ERROR", cur.text || "Failed to load vendor payout request", 500);
  L123: if (!cur.row) return jsonErr("NOT_FOUND", "Vendor payout request not found", 404, { id });

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\components\TripControlWalletPanel.tsx  (hits=7)
  terms: wallet, signature, driver_wallet, vendor_wallet
  L62: export default function TripControlWalletPanel({ trip, drivers, onRefresh }: Props) {
  L140: // Try common signatures (uuid and id)
  L218: <div className="text-xs font-semibold">Trip control & wallet</div>
  L238: <div className="text-[10px] text-slate-500">Driver wallet</div>
  L239: <div className="text-sm font-semibold">{money(trip?.driver_wallet_balance ?? trip?.driver_wallet ?? trip?.driver_balance)}</div>

- app\admin\livetrips\components\TripControlWalletPanel.tsx  (hits=7)
  terms: wallet, signature, driver_wallet, vendor_wallet
  L62: export default function TripControlWalletPanel({ trip, drivers, onRefresh }: Props) {
  L140: // Try common signatures (uuid and id)
  L218: <div className="text-xs font-semibold">Trip control & wallet</div>
  L238: <div className="text-[10px] text-slate-500">Driver wallet</div>
  L239: <div className="text-sm font-semibold">{money(trip?.driver_wallet_balance ?? trip?.driver_wallet ?? trip?.driver_balance)}</div>

- app\admin\livetrips\LiveTripsClient.tsx  (hits=7)
  terms: wallet, payout
  L8: let TripWalletPanel: any = null;
  L10: try { TripWalletPanel = require("./components/TripWalletPanel").default; } catch {}
  L1039: <div className="font-semibold">Driver payout</div>
  L1043: <div className="font-semibold">Driver wallet</div>
  L1048: <div className="font-semibold">Vendor wallet</div>

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\components\TripControlWalletPanel.tsx  (hits=7)
  terms: wallet, signature, driver_wallet, vendor_wallet
  L62: export default function TripControlWalletPanel({ trip, drivers, onRefresh }: Props) {
  L140: // Try common signatures (uuid and id)
  L218: <div className="text-xs font-semibold">Trip control & wallet</div>
  L238: <div className="text-[10px] text-slate-500">Driver wallet</div>
  L239: <div className="text-sm font-semibold">{money(trip?.driver_wallet_balance ?? trip?.driver_wallet ?? trip?.driver_balance)}</div>

- backups\LIVETRIPS_ABC_20251216_100804\LiveTripsClient.tsx  (hits=6)
  terms: wallet, driver_wallet, vendor_wallet
  L280: {/* Trip control + wallet + manual assign */}
  L283: <div className="font-semibold text-xs">Trip control &amp; wallet</div>
  L300: <div className="text-[11px] text-slate-500">Driver wallet</div>
  L301: <div className="font-semibold">{String(selectedTrip?.driverWallet ?? selectedTrip?.driver_wallet ?? "--")}</div>
  L304: <div className="text-[11px] text-slate-500">Vendor wallet</div>

- app\admin\reports\driver-payout-requests\page.tsx  (hits=6)
  terms: payout, wallet
  L5: export default function DriverPayoutRequestsReportPage() {
  L28: <h1 style={{ fontSize: 22, fontWeight: 800, margin: 0 }}>Driver Payout Requests (LGU View)</h1>
  L30: Read-only report launcher. Opens LGU export view with driver payout requests preset. No API calls here.
  L38: Open Driver Payout Requests (LGU)
  L50: <li>No wallet mutations</li>

- app\api\admin\dispatch\assign\route.ts  (hits=6)
  terms: wallet
  L4: function isWalletLockError(msg: string) {
  L6: return m.includes("WALLET_LOCK:");
  L49: // Update booking (DB trigger enforces wallet lock)
  L62: // Wallet lock => return 409 so UI can show a clear message
  L63: if (isWalletLockError(msg)) {

- app\admin\finance\summary\page.tsx  (hits=6)
  terms: payout, wallet
  L241: const driverKeys = ["driver_payout", "driver_amount", "driver_share", "net_driver", "driver_net"];
  L244: let gross = 0, platformFee = 0, driverPayout = 0, vendorTotal = 0;
  L263: if (dp !== null) { driverPayout += dp; driverCount++; }
  L281: { metric: "Driver Payout (best-effort)", value: driverPayout, note: driverCount ? `Derived from ${driverCount} rows` : "No driver payout fields found" },
  L308: Snapshot-based totals derived from existing LiveTrips page-data. GET-only on click. No wallet mutations.

- app\takeout\vendor\ratings\page.tsx  (hits=5)
  terms: payout, billing
  L20: driver_payout: number;
  L137: const grossBillings = useMemo(
  L372: Gross billings
  L375: {formatMoney(grossBillings)}
  L390: Gross billings minus JRide platform fees

- components\components\MembershipCard.tsx  (hits=5)
  terms: topup, top-up
  L9: minTopUps: number;
  L165: Rides: {stats?.currentCycleRides || 0} | Top-ups: {stats?.currentCycleTopUps || 0}
  L186: <span>Top-ups: {stats.currentCycleTopUps}/{nextTier.minTopUps}</span>
  L187: <span>{progress.topUpsNeeded} more needed</span>
  L192: style={{ width: `${Math.min(progress.topUpsProgress, 100)}%` }}

- app\admin\livetrips\components\AdminOpsPanel.tsx  (hits=5)
  terms: wallet, driver_wallet, vendor_wallet
  L132: <div className="text-xs font-semibold">Trip control & wallet</div>
  L150: <div className="text-slate-500">Driver wallet</div>
  L151: <div className="font-semibold">{s(selectedTrip.driver_wallet ?? selectedTrip.driver_wallet_balance ?? "-")}</div>
  L154: <div className="text-slate-500">Vendor wallet</div>
  L155: <div className="font-semibold">{s(selectedTrip.vendor_wallet ?? selectedTrip.vendor_wallet_balance ?? "-")}</div>

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\components\AdminOpsPanel.tsx  (hits=5)
  terms: wallet, driver_wallet, vendor_wallet
  L132: <div className="text-xs font-semibold">Trip control & wallet</div>
  L150: <div className="text-slate-500">Driver wallet</div>
  L151: <div className="font-semibold">{s(selectedTrip.driver_wallet ?? selectedTrip.driver_wallet_balance ?? "—")}</div>
  L154: <div className="text-slate-500">Vendor wallet</div>
  L155: <div className="font-semibold">{s(selectedTrip.vendor_wallet ?? selectedTrip.vendor_wallet_balance ?? "—")}</div>

- components\MembershipCard.tsx  (hits=5)
  terms: topup, top-up
  L9: minTopUps: number;
  L165: Rides: {stats?.currentCycleRides || 0} | Top-ups: {stats?.currentCycleTopUps || 0}
  L186: <span>Top-ups: {stats.currentCycleTopUps}/{nextTier.minTopUps}</span>
  L187: <span>{progress.topUpsNeeded} more needed</span>
  L192: style={{ width: `${Math.min(progress.topUpsProgress, 100)}%` }}

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\components\AdminOpsPanel.tsx  (hits=5)
  terms: wallet, driver_wallet, vendor_wallet
  L132: <div className="text-xs font-semibold">Trip control & wallet</div>
  L150: <div className="text-slate-500">Driver wallet</div>
  L151: <div className="font-semibold">{s(selectedTrip.driver_wallet ?? selectedTrip.driver_wallet_balance ?? "—")}</div>
  L154: <div className="text-slate-500">Vendor wallet</div>
  L155: <div className="font-semibold">{s(selectedTrip.vendor_wallet ?? selectedTrip.vendor_wallet_balance ?? "—")}</div>

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251218_211708_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_041342_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L591: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251218_224520_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_042348_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L612: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251218_192947_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_054057_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_053252_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_060537_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L689: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251218_190920_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L597: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251218_211708_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_060314_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L689: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_055735_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L709: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251218_192947_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251218_191530_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L597: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_052029_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L636: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_STUCKTEXT_PATCH_FIXED_20251220_173047\app\admin\livetrips\LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L13: import TripWalletPanel from "./components/TripWalletPanel";
  L72: driverWalletBalances?: any;
  L73: vendorWalletBalances?: any;
  L533: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_053015_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_STUCKTEXT_PATCH_20251220_172337\app\admin\livetrips\LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L13: import TripWalletPanel from "./components/TripWalletPanel";
  L72: driverWalletBalances?: any;
  L73: vendorWalletBalances?: any;
  L533: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_042348_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L612: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_052029_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L636: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_053252_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_055735_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L709: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_060537_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L689: <TripWalletPanel trip={selectedTrip as any} />

- components\LocationInput.tsx  (hits=4)
  terms: callback
  L3: import React, { useCallback, useMemo, useState } from "react";
  L43: const handleInput = useCallback(
  L53: const selectLocation = useCallback(
  L62: const confirmEnter = useCallback(

- backups\RECOVER_LIVETRIPS_20251219-125448\app\admin\livetrips\LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L16: import TripWalletPanel from "./components/TripWalletPanel";
  L74: driverWalletBalances?: any;
  L75: vendorWalletBalances?: any;
  L705: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_054057_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_060537_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L689: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_053252_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\WALLET_LOCK_API_20251214_093020\route.ts  (hits=4)
  terms: wallet
  L5: import { assertDriverCanAcceptNewJob } from "@/lib/walletGuard";
  L27: // 1) Wallet guard: block if driver wallet below minimum
  L38: "Driver cannot accept new job (wallet below minimum).",
  L39: code: "WALLET_BELOW_MINIMUM",

- backups\_tsx_quarantine\_bak_20251218_190920_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L597: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_053015_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251218_191530_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L597: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_054057_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_041342_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L591: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_060314_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L689: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251219_060314_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L689: <TripWalletPanel trip={selectedTrip as any} />

- backups\_tsx_quarantine\_bak_20251218_224520_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\_bak_20251219_055735_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L709: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_053015_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L679: <TripWalletPanel trip={selectedTrip as any} />

- components\components\LocationInput.tsx  (hits=4)
  terms: callback
  L3: import React, { useCallback, useMemo, useState } from "react";
  L43: const handleInput = useCallback(
  L53: const selectLocation = useCallback(
  L62: const confirmEnter = useCallback(

- app\components\LocationInput.jsx  (hits=4)
  terms: callback
  L3: import React, { useCallback, useMemo, useState } from "react";
  L24: const handleInput = useCallback((e) => {
  L31: const selectLocation = useCallback((loc) => {
  L37: const confirmEnter = useCallback((e) => {

- app\auth\error\page.tsx  (hits=4)
  terms: callback
  L10: | "OAuthCallback"
  L11: | "Callback"
  L23: OAuthCallback: "There was a problem finishing sign-in.",
  L24: Callback: "There was a problem finishing sign-in.",

- app\wallet\topup\page.tsx  (hits=4)
  terms: topup, wallet, top-up
  L5: export default function WalletTopupPage() {
  L7: const onTopup = ()=>alert(`Top-up requested: â‚±${amount || 0}`);
  L10: <h1 className="text-xl font-semibold mb-3">Wallet Top-up</h1>
  L15: disabled={amount==="" || (amount as number)<=0} onClick={onTopup}>Continue</button>

- backups\LiveTripsClient_RENDER_SAFE_FIX_20251220_163705.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L65: driverWalletBalances?: any;
  L66: vendorWalletBalances?: any;
  L526: <TripWalletPanel trip={selectedTrip as any} />

- backups\LiveTripsClient_RENDER_SAFE_20251220_163531.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L65: driverWalletBalances?: any;
  L66: vendorWalletBalances?: any;
  L526: <TripWalletPanel trip={selectedTrip as any} />

- backups\LiveTripsClient_MOJIBAKE_CLEAN_20251220_165041.tsx  (hits=4)
  terms: wallet
  L13: import TripWalletPanel from "./components/TripWalletPanel";
  L72: driverWalletBalances?: any;
  L73: vendorWalletBalances?: any;
  L533: <TripWalletPanel trip={selectedTrip as any} />

- app\api\takeout\admin\vendor-payouts\route.ts  (hits=4)
  terms: payout
  L15: console.error("❌ Supabase env vars missing for admin vendor payouts API");
  L23: .from("admin_vendor_payout_summary")
  L28: console.error("❌ Error loading admin_vendor_payout_summary:", error);
  L37: console.error("❌ admin vendor payouts server error:", err);

- app\api\admin\vendor-payouts-summary\route.ts  (hits=4)
  terms: payout
  L28: ? "admin_vendor_payout_summary"
  L29: : "admin_vendor_payout_monthly";
  L37: if (source === "admin_vendor_payout_monthly") {
  L59: // Return raw JSON array to keep UI simple (same pattern as your payouts list APIs)

- app\api\admin\reports\lgu-driver\route.ts  (hits=4)
  terms: payout
  L24: ? "admin_driver_payout_requests_v1"
  L25: : "admin_driver_payout_daily_v1";
  L39: // Only apply on requests view (safe expectation for payouts request rows).
  L40: if (source === "admin_driver_payout_requests_v1") {

- app\api\admin\driver-payouts\auto-approve\route.ts  (hits=4)
  terms: payout, wallet
  L21: // If your function is public.admin_auto_approve_driver_payouts(limit int) return json, use this:
  L22: const { data, error } = await sb.rpc("admin_auto_approve_driver_payouts", { p_limit: limit });
  L48: message = "Nothing to auto-approve (no pending payouts).";
  L50: message = `No approvals. Skipped ${skippedIns} due to insufficient wallet balance.`;

- app\api\admin\wallet\transactions\route.ts  (hits=4)
  terms: wallet, driver_wallet, vendor_wallet, wallet_transactions
  L77: ? "admin_get_driver_wallet_balance_v1"
  L78: : "admin_get_vendor_wallet_balance_v1";
  L107: const table = kind === "driver" ? "driver_wallet_transactions" : "vendor_wallet_transactions";
  L112: return bad("Wallet tx fetch failed", "WALLET_TX_FETCH_FAILED", 500, { details: (res as any).fatalError });

- app\api\takeout\admin\vendor-payout\list-requests\route.ts  (hits=4)
  terms: payout
  L20: "❌ Supabase env vars missing in admin vendor-payout list-requests API"
  L33: // 1) Fetch all payout requests
  L35: .from("vendor_payout_requests")
  L42: console.error("❌ vendor_payout_requests list error:", requestError);

- app\api\driver\wallet\route.ts  (hits=4)
  terms: wallet, driver_wallet, wallet_transactions
  L19: // READ-ONLY driver wallet snapshot
  L20: // GET /api/driver/wallet?driver_id=UUID&tx_limit=30
  L34: .from("driver_wallet_balances_v1")
  L43: .from("driver_wallet_transactions")

- app\api\driver\payout-requests\route.ts  (hits=4)
  terms: payout
  L19: // READ-ONLY payout request history
  L20: // GET /api/driver/payout-requests?driver_id=UUID&status=all|pending|approved|paid|rejected&limit=50
  L34: .from("driver_payout_requests")
  L35: .select("id,driver_id,amount,status,requested_at,processed_at,payout_method,payout_ref,receipt_url,admin_note")

- backups\LIVETRIPS_CLIENT_RENDER_SANITIZE_20251220_163006.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L65: driverWalletBalances?: any;
  L66: vendorWalletBalances?: any;
  L526: <TripWalletPanel trip={selectedTrip as any} />

- app\api\takeout\admin\settle\route.ts  (hits=4)
  terms: wallet, vendor_wallet, payout
  L34: "settle_vendor_wallet",
  L37: v_note: "Cash payout settlement triggered from admin dashboard",
  L42: console.error("❌ settle_vendor_wallet error:", settleError);
  L44: { error: settleError.message ?? "Failed to settle wallet" },

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_042348_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L612: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251218_211708_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251218_190920_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L597: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_041342_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L591: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251218_224520_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251218_191530_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L597: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251218_192947_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L569: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L65: driverWalletBalances?: any;
  L66: vendorWalletBalances?: any;
  L526: <TripWalletPanel trip={selectedTrip as any} />

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\_bak_20251219_052029_LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L6: import TripWalletPanel from "./components/TripWalletPanel";
  L64: driverWalletBalances?: any;
  L65: vendorWalletBalances?: any;
  L636: <TripWalletPanel trip={selectedTrip as any} />

- backups\DISPATCH_HARDENING_PREPATCH_20251220_174751\app\admin\livetrips\LiveTripsClient.tsx  (hits=4)
  terms: wallet
  L13: import TripWalletPanel from "./components/TripWalletPanel";
  L72: driverWalletBalances?: any;
  L73: vendorWalletBalances?: any;
  L533: <TripWalletPanel trip={selectedTrip as any} />

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013551\livetrips_current\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- app\admin\livetrips\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- UPLOAD_TO_CHATGPT\LiveTripsClient.tsx  (hits=3)
  terms: callback
  L3: import React, { useCallback, useEffect, useMemo, useState } from "react";
  L112: // âœ… CRITICAL FIX: stable callback prevents infinite re-render loop
  L113: const handleStuckChange = useCallback((ids: Set<string>) => {

- app\api\admin\reports\lgu-vendor\route.ts  (hits=3)
  terms: payout
  L25: ? "admin_vendor_payout_summary"
  L26: : "admin_vendor_payout_monthly";
  L33: if (source === "admin_vendor_payout_monthly") {

- backups\RESTORE_LIVETRIPS_20251215_023821\livetrips_current\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_070739\livetrips\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- backups\RESTORE_DISPATCH_FLOW_UI_20251215_095748\livetrips\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- backups\RESTORE_LIVETRIPSCLIENT_20251215_105824\LiveTripsClient.tsx  (hits=3)
  terms: wallet, payout
  L9: import TripWalletPanel from "./components/TripWalletPanel";
  L59: {/* WALLET / PAYOUT */}
  L60: <TripWalletPanel trip={selectedTrip} />

- app\admin\ops\wallet-reconciliation\page.tsx  (hits=3)
  terms: wallet
  L5: export default function WalletReconciliationPage() {
  L8: <h1 style={{ fontSize: 22, fontWeight: 800, margin: 0 }}>Wallet Reconciliation (Read-only)</h1>
  L17: <li>No wallet deductions/credits here.</li>

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013808\livetrips_current\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- lib\walletGuard.ts  (hits=3)
  terms: wallet, load wallet
  L1: // lib/walletGuard.ts
  L7: * Throws a readable error if the wallet is low or negative.
  L21: "Driver wallet is below the minimum required. Please top up load wallet."

- backups\RESTORE_LIVETRIPS_20251215_011908\app\admin\livetrips\LiveTripsClient.tsx  (hits=3)
  terms: callback
  L3: import React, { useCallback, useEffect, useMemo, useState } from "react";
  L112: // âœ… CRITICAL FIX: stable callback prevents infinite re-render loop
  L113: const handleStuckChange = useCallback((ids: Set<string>) => {

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- app\driver\payouts\page.tsx  (hits=3)
  terms: payout
  L4: export default function PayoutsPage() {
  L7: <h1 className="text-xl font-semibold mb-3">Driver Payouts</h1>
  L8: <p className="text-sm text-gray-600">Payout summary will appear here.</p>

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\assign\page.tsx  (hits=3)
  terms: callback
  L6: import { useEffect, useState, useCallback } from "react";
  L36: const loadPending = useCallback(async () => {
  L76: const handleAfterAssign = useCallback(() => {

- middleware.ts  (hits=3)
  terms: callback
  L22: * - session.user.role (set in auth.ts callbacks via email allowlists)
  L56: // If not authenticated, redirect to sign-in with callback
  L61: url.searchParams.set("callbackUrl", req.nextUrl.pathname + (req.nextUrl.search || ""));

- app\admin\reports\lgu\page.tsx  (hits=2)
  terms: payout, wallet
  L284: <button style={btn} onClick={() => setDriverView("requests")}>Payout Requests</button>
  L354: Locked rule: read-only exports. GET only. No wallet mutations. No payout updates.

- components\components\PenaltyNotificationModal.tsx  (hits=2)
  terms: wallet, top-up
  L107: <i className="ri-wallet-line text-orange-600 mt-0.5 mr-2 flex-shrink-0"></i>
  L110: <p>Amount deducted from wallet Ã¢â€ ' points Ã¢â€ ' next top-up. Continue following guidelines to avoid suspension.</p>

- backups\RESTORE_LIVETRIPS_20251215_023821\livetrips_current\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- app\admin\reports\vendor-summary\page.tsx  (hits=2)
  terms: wallet, payout
  L50: <li>No wallet mutations</li>
  L51: <li>No payout actions</li>

- app\admin\reports\vendor-monthly\page.tsx  (hits=2)
  terms: wallet, payout
  L59: <li>No wallet mutations</li>
  L60: <li>No payout actions</li>

- backups\RESTORE_DISPATCH_FLOW_UI_20251215_095748\livetrips\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- components\QuickActions.tsx  (hits=2)
  terms: topup, wallet
  L23: id: 'topup',
  L27: href: '/wallet/topup'

- app\website\WebsiteAuth.tsx  (hits=2)
  terms: wallet
  L215: <i className="ri-wallet-line text-green-600 text-xl"></i>
  L219: <p className="text-sm text-gray-600">Wallet Balance</p>

- app\admin\livetrips\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- app\takeout\page.tsx  (hits=2)
  terms: wallet
  L319: // Client-only estimate (NO wallet math)
  L615: This is an estimate for items only. Delivery fees/wallet math are unchanged.

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_070739\livetrips\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013551\livetrips_current\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- app\auth-impl.ts  (hits=2)
  terms: callback
  L5: // (Optional) tweak callbacks to put name/email on the session like your UI expects.
  L14: callbacks: {

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- backups\orders-api\route_20251210_030017.ts  (hits=2)
  terms: payout
  L49: "driver_payout",
  L83: driver_payout: Number(data.driver_payout ?? 0),

- _scan_pickupfee_hits.txt  (hits=2)
  terms: wallet
  L11: @{Path=C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\livetrips\components\TripWalletPanel.tsx; LineNumber=35; Line= * base_fee, distance_fare, extra_stop_fee, waiting_fee}
  L12: @{Path=C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\livetrips\components\TripWalletPanel.tsx; LineNumber=72; Line=  const distFare = asNum(trip?.distance_fare) ?? 0;}

- app\api\admin\livetrips\backfill-takeout\route.ts  (hits=2)
  terms: merchant
  L43: const latKeys = ["lat","latitude","location_lat","pickup_lat","from_lat","start_lat","vendor_lat","store_lat","merchant_lat"];
  L44: const lngKeys = ["lng","lon","longitude","location_lng","pickup_lng","from_lng","start_lng","vendor_lng","store_lng","merchant_lng"];

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013808\livetrips_current\status-test\page.tsx  (hits=2)
  terms: callback
  L3: import { useCallback, useEffect, useState } from "react";
  L18: const loadTrips = useCallback(async () => {

- components\PenaltyNotificationModal.tsx  (hits=2)
  terms: wallet, top-up
  L107: <i className="ri-wallet-line text-orange-600 mt-0.5 mr-2 flex-shrink-0"></i>
  L110: <p>Amount deducted from wallet Ã¢â€ ' points Ã¢â€ ' next top-up. Continue following guidelines to avoid suspension.</p>

- components\components\QuickActions.tsx  (hits=2)
  terms: topup, wallet
  L23: id: 'topup',
  L27: href: '/wallet/topup'

- app\api\admin\driver-payouts\export\route.ts  (hits=2)
  terms: payout
  L24: let q = sb.from("driver_payout_requests")
  L41: "Content-Disposition": `attachment; filename="driver_payouts_export.csv"`,

- app\api\vendor-orders\route.ts  (hits=2)
  terms: merchant
  L31: const latKeys = ["lat","latitude","location_lat","pickup_lat","from_lat","start_lat","vendor_lat","store_lat","merchant_lat"];
  L32: const lngKeys = ["lng","lon","longitude","location_lng","pickup_lng","from_lng","start_lng","vendor_lng","store_lng","merchant_lng"];

- _zip_takeout_express_stage\app\takeout\orders\page.tsx  (hits=1)
  terms: payout
  L20: driver_payout?: number | string | null;

- _restorepoints\POST_RESTOREPOINT_COMPLETED_FIX_20251220_192151\route.ts.bak_route.ts  (hits=1)
  terms: payout
  L66: "driver_payout",

- components\StarRating.tsx  (hits=1)
  terms: callback
  L21: category, // not used internally, but handy for parent callbacks/debug

- components\components\ReferralSection.tsx  (hits=1)
  terms: checkout
  L221: <li>Ã¢â‚¬¢ 1 point = Ã¢â€š±1 ride credit (auto-applied at checkout)</li>

- components\ReferralSection.tsx  (hits=1)
  terms: checkout
  L221: <li>Ã¢â‚¬¢ 1 point = Ã¢â€š±1 ride credit (auto-applied at checkout)</li>

- configs\nextauth.ts  (hits=1)
  terms: callback
  L14: callbacks: {

- components\components\StarRating.tsx  (hits=1)
  terms: callback
  L21: category, // not used internally, but handy for parent callbacks/debug

- components\AssignNearestButton.tsx  (hits=1)
  terms: callback
  L21: // Optional callback for parent pages (e.g. to reload tables)

- app\components\UserMenu.tsx  (hits=1)
  terms: callback
  L41: onClick={() => signOut({ callbackUrl: "/auth/signin" })}

- app\passenger\page.tsx  (hits=1)
  terms: callback
  L23: window.location.href = "/api/auth/signin?callbackUrl=" + cb;

- app\auth\signin\GoogleSignInButton.tsx  (hits=1)
  terms: callback
  L9: onClick={() => signIn("google", { callbackUrl: "/" })}

- app\callback-info\page.tsx  (hits=1)
  terms: callback
  L4: export default function CallbackInfo() {

- backups\LIVETRIPS_FRONTEND_ASCII_ONLY_20251220_153307\app\admin\livetrips\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- .env.local  (hits=1)
  terms: wallet, driver_wallet
  L35: MIN_DRIVER_WALLET_REQUIRED=250

- app\takeout\orders\page.tsx  (hits=1)
  terms: payout
  L20: driver_payout?: number | string | null;

- backup-livetrips-20251126\LiveTrips.local.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- app\api\takeout\orders-list\route.ts  (hits=1)
  terms: payout
  L60: driver_payout

- next.config.cjs  (hits=1)
  terms: callback
  L5: { source: "/auth/callback", destination: "/auth/callback-info", permanent: true },

- app\admin\livetrips\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- auth.config.ts  (hits=1)
  terms: callback
  L17: callbacks: {

- auth.ts  (hits=1)
  terms: callback
  L39: callbacks: {

- app\api\admin\payouts\approve\route.ts  (hits=1)
  terms: payout
  L20: const { data, error } = await supabase.rpc("admin_mark_payout_paid_v1", {

- app\api\admin\payouts\reject\route.ts  (hits=1)
  terms: payout
  L20: const { data, error } = await supabase.rpc("admin_reject_payout_v1", {

- app\admin\ops\incidents\page.tsx  (hits=1)
  terms: wallet
  L336: Locked rule: read-only UI. GET-only on click. No wallet mutations. No Mapbox changes. No LiveTrips logic changes.

- app\api\admin\complete-trip\route.ts  (hits=1)
  terms: wallet
  L28: const rpcName = "admin_finalize_trip_and_credit_wallets";

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- backups\RESTORE_BASELINE_LIVETRIPS_20251216_074339\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L196: // STUCK CALLBACK

- backups\RESTORE_DISPATCH_FLOW_UI_20251215_095748\livetrips\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_070739\livetrips\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_070739\livetrips\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\RESTORE_LIVETRIPS_20251215_023821\livetrips_current\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\vendor-orders\page_20251209_170435.tsx  (hits=1)
  terms: payout
  L86: payouts.

- backups\RESTORE_DISPATCH_FLOW_UI_20251215_095748\livetrips\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L178: // STUCK CALLBACK

- backups\RESTORE_LIVETRIPS_20251215_023821\livetrips_current\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013808\livetrips_current\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\livetTrips\20251209_083811\app\admin\livetrips\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\RESTORE_ADV_LIVETRIPS_20251219-125936\app\admin\livetrips\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\LIVETRIPS_RESTORE_20251219-140303\app\admin\livetrips\components\TripLifecycleActions.tsx  (hits=1)
  terms: callback
  L8: onAfterAction?: () => void; // refresh callback

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013551\livetrips_current\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013808\livetrips_current\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

- backups\RESTORE_ADV_LIVETRIPS_20251219-130226\app\admin\livetrips\LiveTripsClient.tsx  (hits=1)
  terms: callback
  L183: // STUCK CALLBACK

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013551\livetrips_current\LiveTrips.tsx  (hits=1)
  terms: callback
  L31: // You can later add a callback here to refresh SWR/React Query, etc.

=== 2) API Route Candidates (payments/wallet/webhooks) ===
- _patch_backups\20251222-182002\app\api\admin\livetrips\page-data\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\admin\complete-trip\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\admin\dispatch\assign\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\admin\driver-payouts\auto-approve\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\admin\driver-payouts\export\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\driver-payouts\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\livetrips\apply-fare\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\payouts\approve\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\payouts\reject\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\reconcile-wallets\fix\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\admin\reconcile-wallets\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\admin\reports\lgu-driver\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\reports\lgu-vendor\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\vendor-payouts\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\admin\vendor-payouts-summary\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\admin\wallet\transactions\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\dispatch\drivers-live\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\dispatch\status\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\driver\payout-request\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\driver\payout-requests\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\driver\wallet\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\public\passenger\book\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\public\passenger\can-book\route.ts
    signals: api=True webhook=False checkout=False payout=False wallet=True
- app\api\takeout\admin\settle\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\takeout\admin\vendor-payout\list-requests\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\takeout\admin\vendor-payout\settle-request\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\takeout\admin\vendor-payouts\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\takeout\orders-list\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=False
- app\api\takeout\vendor\payout\details\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\takeout\vendor\payout\request\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\takeout\vendor\payout\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\takeout\vendor\request-payout\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\takeout\vendor-wallet\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True
- app\api\vendor\payout-request\route.ts
    signals: api=True webhook=False checkout=False payout=True wallet=True

=== 3) Env / Config Hints ===
3A) .env* / vercel.json / next.config.*

- .env.local  (hits=1)
  terms: WALLET
  L35: MIN_DRIVER_WALLET_REQUIRED=250

3B) code references (process.env, etc.)

- powershell.txt  (hits=866)
  terms: payout, wallet
  L112: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                     76             title: "Driver Payouts",
  L113: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                     77             desc: "Driver payout records and status overview.",
  L114: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                     78             href: "/admin/driver-payouts",
  L115: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                    112             title: "Driver Payout Requests (LGU View)",
  L116: C:\Users\jwes9\Desktop\jride-clean-fresh\app\admin\control-center\page.tsx                                    113             desc: "LGU-safe view of driver payout requests.",

- app\takeout\vendor\payout\page.tsx  (hits=76)
  terms: wallet, payout
  L10: wallet_balance: number;
  L11: last_payout_at: string | null;
  L12: last_payout_amount: number | null;
  L21: total_payouts: number;
  L37: type WalletTx = {

- components\PaymentMethodModal.tsx  (hits=68)
  terms: payment, gcash, xendit, wallet
  L6: interface PaymentMethodModalProps {
  L9: onConfirm: (paymentMethod: 'wallet' | 'cash' | 'points' | 'gcash_xendit') => void;
  L13: export default function PaymentMethodModal({ isOpen, onClose, onConfirm, rideAmount }: PaymentMethodModalProps) {
  L14: const [selectedMethod, setSelectedMethod] = useState<'wallet' | 'cash' | 'points' | 'gcash_xendit'>('cash');
  L15: const [walletBalance, setWalletBalance] = useState(0);

- components\components\PaymentMethodModal.tsx  (hits=68)
  terms: payment, gcash, xendit, wallet
  L6: interface PaymentMethodModalProps {
  L9: onConfirm: (paymentMethod: 'wallet' | 'cash' | 'points' | 'gcash_xendit') => void;
  L13: export default function PaymentMethodModal({ isOpen, onClose, onConfirm, rideAmount }: PaymentMethodModalProps) {
  L14: const [selectedMethod, setSelectedMethod] = useState<'wallet' | 'cash' | 'points' | 'gcash_xendit'>('cash');
  L15: const [walletBalance, setWalletBalance] = useState(0);

- app\takeout\admin\payouts\page.tsx  (hits=41)
  terms: wallet, payout
  L13: wallet_balance: number;
  L14: last_payout_at: string | null;
  L15: last_payout_amount: number | null;
  L18: export default function AdminVendorPayoutsPage() {
  L28: const res = await fetch("/api/takeout/admin/vendor-payouts");

- app\driver\page.tsx  (hits=40)
  terms: wallet, payout, gcash
  L18: type WalletStatus = {
  L20: wallet_balance: number;
  L21: min_wallet_required: number;
  L22: wallet_status: string | null;
  L26: type Payout = {

- app\admin\payouts\drivers\page.tsx  (hits=37)
  terms: payout, wallet, gcash
  L8: type PayoutRow = {
  L16: payout_method: string | null;
  L17: payout_ref: string | null;
  L20: wallet_balance?: number | null;
  L21: min_wallet_required?: number | null;

- app\dispatch\page.tsx  (hits=37)
  terms: wallet
  L289: const [lowWalletOnly, setLowWalletOnly] = useState<boolean>(false);
  L295: /* JRIDE_UI_MONEY_PHASE2_LOWWALLET_PANEL_START */
  L296: const lowWalletDrivers = useMemo(() => {
  L308: const bal = toNum((d as any).wallet_balance);
  L309: const min = toNum((d as any).min_wallet_required);

- app\api\public\passenger\can-book\route.ts  (hits=37)
  terms: wallet
  L166: async function resolvePassengerWallet(supabase: ReturnType<typeof createClient>) {
  L170: wallet_locked: false,
  L171: wallet_balance: null as number | null,
  L172: min_wallet_required: null as number | null,
  L182: out.note = "No auth user (not signed in). Wallet precheck not enforced.";

- app\api\takeout\vendor-wallet\route.ts  (hits=25)
  terms: wallet, payout
  L51: console.error("❌ Supabase env vars missing for vendor-wallet API");
  L60: // 0) Auto-sync this vendor's completed TAKEOUT orders into the wallet
  L62: "sync_vendor_takeout_wallet",
  L67: console.error("❌ Error running sync_vendor_takeout_wallet:", syncError);
  L68: // Continue; wallet may still contain previous data.

- app\api\takeout\vendor\payout\details\route.ts  (hits=23)
  terms: payout, wallet
  L19: console.error("❌ Supabase env vars missing in vendor payout details API");
  L59: .from("admin_vendor_payout_summary")
  L61: "vendor_id,total_billings,total_platform_fees,total_vendor_earnings,wallet_balance,last_payout_at,last_payout_amount"
  L67: console.error("❌ admin_vendor_payout_summary error:", summaryError);
  L78: .from("admin_vendor_payout_monthly")

- app\wallet\page.tsx  (hits=23)
  terms: wallet, payout, payment
  L11: wallet_balance: number;
  L16: type: 'credit' | 'debit' | 'topup' | 'payout' | 'ride' | 'errand' | 'vendor_order';
  L24: export default function WalletPage() {
  L32: loadWalletData();
  L63: loadWalletData();

- app\ride\page.tsx  (hits=22)
  terms: wallet
  L264: wallet_ok?: boolean;
  L265: wallet_locked?: boolean;
  L266: wallet_balance?: number | null;
  L267: min_wallet_required?: number | null;
  L268: wallet_source?: string;

- _patch_backups\20251222-182002\app\api\admin\livetrips\page-data\route.ts  (hits=22)
  terms: wallet
  L75: // 3) Wallet enrichment (best-effort, never blocks response)
  L76: const driverWalletBalances: Record<string, number> = {};
  L77: const vendorWalletBalances: Record<string, number> = {};
  L100: .from("driver_wallet_balances_v1")
  L105: console.error("[wallet] driver_wallet_balances_v1 error", derr);

- app\takeout\admin\payout-requests\page.tsx  (hits=21)
  terms: payout, wallet
  L6: type PayoutRequestRow = {
  L19: export default function AdminPayoutRequestsPage() {
  L24: const [rows, setRows] = useState<PayoutRequestRow[]>([]);
  L32: "/api/takeout/admin/vendor-payout/list-requests"
  L37: throw new Error(json.error || "Failed to load payout requests.");

- app\driver\wallet\page.tsx  (hits=21)
  terms: wallet, payout
  L5: type WalletTx = {
  L15: type PayoutReq = {
  L22: payout_method: string | null;
  L23: payout_ref: string | null;
  L36: export default function DriverWalletPage() {

- components\DriverWalletLedger.tsx  (hits=21)
  terms: payment, wallet, payout, transfer
  L14: payment_method?: string;
  L21: payment_details?: any;
  L46: interface DriverWalletLedgerProps {
  L51: export default function DriverWalletLedger({ isOpen, onClose }: DriverWalletLedgerProps) {
  L71: const response = await fetch(`${process.env.NEXT_PUBLIC_SUPABASE_URL}/functions/v1/wallet-service`, {

- app\admin\livetrips\components\TripWalletPanel.tsx  (hits=21)
  terms: wallet, payout
  L120: export default function TripWalletPanel(props: Props) {
  L128: const vb = asNum(trip?.vendor_wallet_balance);
  L138: const vb = asNum(trip?.vendor_wallet_balance);
  L166: // If no explicit field, for TAKEOUT show derived cut from vendor_wallet_balance (10% rule)
  L170: const driverPayout = useMemo(() => {

- components\components\DriverWalletLedger.tsx  (hits=21)
  terms: payment, wallet, payout, transfer
  L14: payment_method?: string;
  L21: payment_details?: any;
  L46: interface DriverWalletLedgerProps {
  L51: export default function DriverWalletLedger({ isOpen, onClose }: DriverWalletLedgerProps) {
  L71: const response = await fetch(`${process.env.NEXT_PUBLIC_SUPABASE_URL}/functions/v1/wallet-service`, {

- app\api\dispatch\drivers-live\route.ts  (hits=20)
  terms: wallet
  L172: const walletSources = [
  L181: const walletRes = await trySources(supabase, walletSources, "*");
  L206: const walletById: Record<string, any> = {};
  L207: const walletSrcById: Record<string, string> = {};
  L208: if (walletRes) {

- backups\RESTORE_BASELINE_JRIDE_LIVETRIPS_20251215_013808\livetrips_current\components\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- app\api\dispatch\status\route.ts  (hits=19)
  terms: wallet
  L185: * PHASE 3L - wallet sync (completion only)
  L186: * IMPORTANT: Do NOT call admin_finalize_trip_and_credit_wallets(text)
  L187: * because you have a DB trigger that credits driver wallet on status -> completed.
  L191: * - apply platform cut via process_booking_wallet_cut(p_booking_id uuid)
  L192: * - for takeout: sync vendor wallet via sync_vendor_takeout_wallet(v_vendor_id uuid)

- backups\RESTORE_LIVETRIPS_20251215_023821\livetrips_current\components\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- backups\KEEP_AdminPayoutPanel_20251215_024101\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

- backups\PAYOUT_PANEL_SCROLL_FIX_20251214_092634\app\admin\livetrips\components\AdminPayoutPanel.tsx  (hits=19)
  terms: payout, wallet
  L5: export type AdminPayoutRow = {
  L16: wallet_balance: number | null;
  L17: min_wallet_required: number | null;
  L18: wallet_is_locked: boolean | null;
  L22: rows: AdminPayoutRow[];

... (truncated env/code section to first 25 files in TXT report; see JSON for full)

=== 4) SQL / DB (wallet/transactions/payout) Hints ===
No SQL/prisma hints found.

=== 5) Quick Interpretation Guide ===
- Provider names + webhook/checkout routes => some payment integration likely exists.
- Only wallet tables/functions but no provider/webhook => wallet is likely internal + cash-in/out is manual/admin-driven.
- Payout/withdraw endpoints + provider calls => drivers/vendors can likely cash out via that provider.

End of report.
